# Отладка проблемы с регистрацией на Railway

## Проблема
При попытке зарегистрироваться появляется ошибка "Не удалось создать аккаунт. Возможно, username уже занят."

## Что я исправил

1. ✅ Улучшена обработка ошибок в `frontend/src/api.ts` - теперь передается реальная ошибка от сервера
2. ✅ Улучшена обработка ошибок в `frontend/src/pages/Register.tsx` - теперь показываются конкретные сообщения об ошибках

## Как проверить проблему

### Шаг 1: Проверьте логи бэкенда в Railway

1. Откройте ваш Backend сервис в Railway
2. Перейдите во вкладку **Deployments**
3. Откройте последний деплой
4. Перейдите в **Logs**
5. Попробуйте зарегистрироваться снова
6. Проверьте логи - там должны быть ошибки, если они есть

### Шаг 2: Проверьте Volume для базы данных

1. В Railway: Backend сервис → **Settings** → **Volumes**
2. Убедитесь, что создан Volume с Mount Path: `/app/data`
3. Если Volume не создан - создайте его и передеплойте бэкенд

### Шаг 3: Проверьте переменные окружения

В Railway: Backend сервис → **Settings** → **Variables**

Убедитесь, что установлены:
```
DATABASE_PATH=/app/data/db.sqlite
NODE_ENV=production
PORT=3000
JWT_SECRET=ваш-секретный-ключ
```

### Шаг 4: Проверьте API запросы

1. Откройте фронтенд в браузере
2. Откройте DevTools (F12) → **Network**
3. Попробуйте зарегистрироваться
4. Найдите запрос `/api/auth/register`
5. Проверьте:
   - **Request URL** - должен быть правильный URL бэкенда
   - **Request Payload** - должны быть username и password
   - **Response** - проверьте статус и тело ответа

### Шаг 5: Проверьте CORS

Убедитесь, что бэкенд разрешает запросы с домена фронтенда:

1. Откройте `backend/src/app.ts`
2. Проверьте настройки CORS
3. Убедитесь, что в переменных окружения есть `FRONTEND_URL` с URL вашего фронтенда

## Возможные причины ошибки

### 1. База данных не создается

**Решение**: Проверьте логи бэкенда. Должна быть строка "Server on http://localhost:3000" без ошибок.

### 2. Volume не смонтирован

**Решение**: Создайте Volume в Railway с Mount Path `/app/data` и передеплойте.

### 3. Ошибка при создании таблиц

**Решение**: Проверьте логи - там должны быть ошибки SQL, если они есть.

### 4. Username действительно занят

**Решение**: Попробуйте другой username.

### 5. Проблемы с CORS

**Решение**: Проверьте, что запросы доходят до бэкенда (в Network tab).

## Тестирование

После исправлений попробуйте:

1. Зарегистрироваться с новым username
2. Проверить логи бэкенда
3. Проверить Network tab в браузере
4. Посмотреть на конкретное сообщение об ошибке (теперь оно должно быть более информативным)

## Если проблема не решается

1. Проверьте логи бэкенда - там должна быть детальная информация об ошибке
2. Проверьте, что Volume создан и смонтирован правильно
3. Попробуйте пересоздать Volume и передеплоить бэкенд
4. Проверьте, что переменные окружения установлены правильно
